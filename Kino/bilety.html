<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Kinomax - Bilety</title>
  <link rel="stylesheet" href="style.css">

</head>
<body>
  <header>
    <h1>Kinomax</h1>
    <nav>
      <ul>
        <li><a href="index.html">Strona główna</a></li>
        <li><a href="filmy.html">Filmy</a></li>
        <li><a href="repertuar.html">Repertuar</a></li>
        <li><a href="bilety.html">Bilety</a></li>
        <li><a href="kontakt.html">Kontakt</a></li>
      </ul>
    </nav>
  </header>
<div id="content">
  <h2>Rezerwacja biletów</h2>

  <form>
    <label for="month">Miesiąc:</label>
    <select id="month">
      <option value="czerwiec" selected>Czerwiec</option>
      <!-- Dodaj opcje dla pozostałych miesięcy tutaj -->
    </select>

    <label for="day">Dzień:</label>
    <select id="day">
      <option value="">WYBIERZ</option>
      <option value="5">5</option>
      <option value="6">6</option>
      <option value="7">7</option>
      <option value="8">8</option>
      <option value="9">9</option>
      <!-- Dodaj opcje dla pozostałych dni tutaj -->
    </select>

    <label for="movie">Film:</label>
    <select id="movie">
      <option value="" disabled selected>Wybierz</option>
      <!-- Dynamicznie generowane opcje filmów -->
    </select>

    <label for="time">Godzina:</label>
    <select id="time">
      <option value="" disabled selected>Wybierz</option>
      <!-- Dynamicznie generowane opcje godzin -->
    </select>

    <label for="hall">Sala:</label>
    <select id="hall">
      <option value="" disabled selected>Wybierz</option>
      <!-- Dynamicznie generowane opcje sal -->
    </select>

    <div id="seats"></div>

    <button type="submit" disabled>Zarezerwuj</button>
  </form>
</div>

<footer>
  <p>© 2023 Kinomax. Wszelkie prawa zastrzeżone.</p>
</footer>

<script>
  const seatsData = {
    sala1: [
      ['A1', 'A2', 'A3', 'A4', 'A5', 'A6', 'A7', 'A8'],
      ['B1', 'B2', 'B3', 'B4', 'B5', 'B6', 'B7', 'B8'],
      ['C1', 'C2', 'C3', 'C4', 'C5', 'C6', 'C7', 'C8'],
      ['D1', 'D2', 'D3', 'D4', 'D5', 'D6', 'D7', 'D8'],
      ['E1', 'E2', 'E3', 'E4', 'E5', 'E6', 'E7', 'E8'],
      ['F1', 'F2', 'F3', 'F4', 'F5', 'F6', 'F7', 'F8']
    ],
    sala2: [
      ['G1', 'G2', 'G3', 'G4', 'G5', 'G6', 'G7', 'G8'],
      ['H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8'],
      ['I1', 'I2', 'I3', 'I4', 'I5', 'I6', 'I7', 'I8'],
      ['J1', 'J2', 'J3', 'J4', 'J5', 'J6', 'J7', 'J8'],
      ['K1', 'K2', 'K3', 'K4', 'K5', 'K6', 'K7', 'K8'],
      ['L1', 'L2', 'L3', 'L4', 'L5', 'L6', 'L7', 'L8']
    ],
    sala3: [
      ['G1', 'G2', 'G3', 'G4', 'G5', 'G6', 'G7', 'G8'],
      ['H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8'],
      ['I1', 'I2', 'I3', 'I4', 'I5', 'I6', 'I7', 'I8'],
      ['J1', 'J2', 'J3', 'J4', 'J5', 'J6', 'J7', 'J8'],
      ['K1', 'K2', 'K3', 'K4', 'K5', 'K6', 'K7', 'K8'],
      ['L1', 'L2', 'L3', 'L4', 'L5', 'L6', 'L7', 'L8']
    ]
  };

  const bookedHalls = {}; // Obiekt przechowujący przypisane sale w danym czasie

  function generateOptions(selectElement, options) {
    options.forEach((option) => {
      const optionElement = document.createElement('option');
      optionElement.value = option;
      optionElement.textContent = option;
      selectElement.appendChild(optionElement);
    });
  }

  function updateMovieOptions() {
    const month = document.getElementById('month').value;
    const day = document.getElementById('day').value;

    const movieSelect = document.getElementById('movie');
    movieSelect.innerHTML = '';

    if (day === '') {
      const optionElement = document.createElement('option');
      optionElement.disabled = true;
      optionElement.selected = true;
      optionElement.textContent = 'Wybierz';
      movieSelect.appendChild(optionElement);
      return;
    }

    const movies = getMoviesByDate(month, day);

    if (movies.length === 0) {
      const optionElement = document.createElement('option');
      optionElement.disabled = true;
      optionElement.textContent = 'Brak filmów';
      movieSelect.appendChild(optionElement);
      return;
    }

    generateOptions(movieSelect, movies);
    updateHallOptions();
  }

  function updateHallOptions() {
    const movie = document.getElementById('movie').value;
    const timeSelect = document.getElementById('time');
    const hallSelect = document.getElementById('hall');

    timeSelect.innerHTML = '';
    hallSelect.innerHTML = '';

    if (movie === '') {
      const optionElement = document.createElement('option');
      optionElement.disabled = true;
      optionElement.selected = true;
      optionElement.textContent = 'Wybierz';
      timeSelect.appendChild(optionElement);
      hallSelect.appendChild(optionElement.cloneNode(true));
      return;
    }

    const { time, halls } = getTimesAndHallsByMovie(movie);

    if (time.length === 1) {
      const optionElement = document.createElement('option');
      optionElement.value = time[0];
      optionElement.textContent = time[0];
      timeSelect.appendChild(optionElement);
    } else {
      generateOptions(timeSelect, time);
    }

    // Filtrujemy dostępne sale, aby wykluczyć te, które są już zajęte w danym czasie
    const availableHalls = halls.filter((hall) => {
      const bookedHall = bookedHalls[timeSelect.value];
      return !bookedHall || bookedHall !== hall;
    });

    if (availableHalls.length === 1) {
      const optionElement = document.createElement('option');
      optionElement.value = availableHalls[0];
      optionElement.textContent = availableHalls[0];
      hallSelect.appendChild(optionElement);
    } else {
      generateOptions(hallSelect, availableHalls);
    }

    updateSeatSelection();
  }

  function updateSeatSelection() {
    const hall = document.getElementById('hall').value;
    const seats = seatsData[hall];

    const seatsContainer = document.getElementById('seats');
    seatsContainer.innerHTML = '';

    seats.forEach((row) => {
      const rowElement = document.createElement('div');
      rowElement.classList.add('seat-row');

      row.forEach((seat) => {
        const seatElement = document.createElement('div');
        seatElement.classList.add('seat');
        seatElement.textContent = seat;
        rowElement.appendChild(seatElement);
      });

      seatsContainer.appendChild(rowElement);
    });
  }

  function enableSubmitButton() {
    const submitButton = document.querySelector('button[type="submit"]');
    submitButton.disabled = false;
  }

  function disableSubmitButton() {
    const submitButton = document.querySelector('button[type="submit"]');
    submitButton.disabled = true;
  }

  function getMoviesByDate(month, day) {
    if (month === 'czerwiec' && day === '5') {
      return ['SPIDER-MAN: POPRZEZ MULTIWERSUM', 'SZYBCY I WŚCIEKLI 10'];
    } else if (month === 'czerwiec' && day === '6') {
      return ['SPIDER-MAN: POPRZEZ MULTIWERSUM', 'STRAŻNICY GALAKTYKI: VOLUME 3'];
    } else if (month === 'czerwiec' && day === '7') {
      return ['MOJE WAKACJE Z RUDYM', 'PADDINGTON 2'];
    } else if (month === 'czerwiec' && day === '8') {
      return ['MOJE WAKACJE Z RUDYM', 'MILCZENIE'];
    } else if (month === 'czerwiec' && day === '9') {
      return ['	STRAŻNICY GALAKTYKI: VOLUME 3', 'PADDINGTON 2'];
    }
    return [];
  }

  function getTimesAndHallsByMovie(movie) {
    if (movie === 'SZYBCY I WŚCIEKLI 10') {
      return {
        time: ['19:00'],
        halls: ['sala1']
      };
    } else if (movie === 'SPIDER-MAN: POPRZEZ MULTIWERSUM') {
      return {
        time: ['15:00'],
        halls: ['sala1']
      };
    } else if (movie === 'STRAŻNICY GALAKTYKI: VOLUME 3') {
      return {
        time: ['14:00'],
        halls: ['sala2']
      };
    } else if (movie === 'MOJE WAKACJE Z RUDYM') {
      return {
        time: ['16:00'],
        halls: ['sala2']
      };
    } else if (movie === 'MILCZENIE') {
      return {
        time: ['18:00'],
        halls: ['sala3']
      };
    } else if (movie === 'PADDINGTON 2') {
      return {
        time: ['14:00'],
        halls: ['sala3']
      };
    }
    return {
      time: [],
      halls: []
    };
  }

  document.getElementById('month').addEventListener('change', updateMovieOptions);
  document.getElementById('day').addEventListener('change', updateMovieOptions);
  document.getElementById('movie').addEventListener('change', updateHallOptions);
  document.getElementById('time').addEventListener('change', updateSeatSelection);
  document.getElementById('hall').addEventListener('change', updateSeatSelection);
  document.getElementById('seats').addEventListener('click', enableSubmitButton);
  document.querySelector('form').addEventListener('submit', (event) => {
    event.preventDefault();
    alert('Bilet zarezerwowany!');
    disableSubmitButton();
  });

  updateMovieOptions();
</script>
</div>
</body>
</html>
